$(document).ready(function(){publisher.initialize()});let publisher={formId:"signUpForm",errorMessage:"",errorInputIds:[],data:[],countries:["India","United States","Singapore","France","United Kingdom","Australia","Japan","China","Other"],initialize:function(){let t=$("#"+this.formId),e=t.find("input[data-type=number]");e.length>0&&this.listenOnKeyUp(e),this.initializeAutoCompleteCountry(),$("#intlPhoneCode").materialSelect(),t.submit(function(){return!1});let a=this;$("#submit").on("click",function(){a.storeFormDataOnChange()})},initializeAutoCompleteCountry:function(){$("#country").mdbAutocomplete({data:this.countries})},listenOnKeyUp:function(t){for(let e=0;e<t.length;e++)$(t[e]).on("keyup",this.updateField)},updateField:function(t){let e=t.keyCode||t.which,a=$(this),r=a.val();if((e<48||e>57)&&8!==e)return r.length>1&&(r=r.substr(0,r.length-1)),void a.val(r);if("zipcode"!==a.attr("name"))r.length>12?a.val(r.substr(0,r.length-1)):r.length%3==0&&r.length<5&&8!==e?a.val(r+"-"):r.length%7==0&&r.length>5&&8!==e&&a.val(r+"-");else{let t="US";r.length>5&&"US"===t?a.val(r.substr(0,r.length-1)):r.length>7&&a.val(r.substr(0,r.length-1))}},storeFormDataOnChange:function(){let t=$("#"+this.formId).find("input");if(t.length<1)return;this.clearData();for(let e=0;e<t.length;e++){let a=$(t[e]);void 0!==a.attr("validate-field")&&!1!==a.attr("validate-field")&&("number"===a.attr("data-type")?this.validateNumber(a):this.validateValue(a))}let e=this.errorMessage;""===e.trim()&&this.performSubmission(),this.errorMessage="",this.showModalForInputError(e),this.handleModalErrorGoToBtn($("#formErrorModal"))},validateNumber:function(t){let e=t.attr("name"),a=t.val(),r=this,i=/[0-9]/g,s="",n=$("#intlPhoneCode");void 0!==n&&n.length>0&&(s="+"+(s=n.val())+"-"),void 0!==a&&a.length>1&&/[0-9][-]/g.test(a)?r.addToData(e,s+a):"zipcode"===t.attr("name")&&void 0!==a&&a.length>1&&i.test(a)?r.addToData(e,a):(this.errorMessage+="Please enter a valid value for "+t.attr("name")+"<br>",this.errorInputIds.push(t.attr("id")))},validateValue:function(t){let e=t.val(),a=t.attr("name"),r=this;if((e.length<1||""===e.trim())&&"address2"!==a)return this.errorMessage+="Please enter a value for "+a+"<br>",void this.errorInputIds.push(t.attr("id"));if(a.toLowerCase().includes("name")||"city"===a||"state"===a){/[a-z]/gi.test(e)?r.addToData(a,e):(this.errorMessage+="Please enter a valid value for "+a+"<br>",this.errorInputIds.push(t.attr("id")))}else if(a.toLowerCase().includes("country")){for(let t=0;t<this.countries.length;t++)if(e.trim()===this.countries[t])return void r.addToData(a,e);this.errorMessage+="Please select a valid option/value for "+a+"<br>",this.errorInputIds.push(t.attr("id"))}else if(a.includes("email")){/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)?r.addToData(a,e):(this.errorMessage+="Please enter a valid value for "+a+"<br>",this.errorInputIds.push(t.attr("id")))}else"address1"===a&&(e.length>1&&""!==e.trim()?r.addToData(a,e):(this.errorMessage+="Please enter a valid value for "+a+"<br>",this.errorInputIds.push(t.attr("id")))),"address2"===a&&e.length>1&&""!==e.trim()&&r.addToData(a,e)},addToData:function(t,e){this.data.push({name:t,value:e})},removeFromData:function(t){this.data.splice(t,1)},clearData:function(){this.data=[]},showModalForInputError:function(t){t.length<2||""===t.trim()||($("#errorMessage").html(t),$("#errorFormFocusBtn").attr("data-link",this.errorInputIds[0]),$("#formErrorModal").modal("show"))},handleModalErrorGoToBtn:function(t){$("#errorFormFocusBtn").on("click",function(){$(this).off("click");let e=$(this).attr("data-link");t.modal("hide"),$("#"+e).focus()})},performSubmission:function(){this.data.push({name:"signUpForm",value:$("#"+this.formId).attr("name")});let t=$("#status");$.ajax({url:"php/advertiseOrPublish.php",type:"POST",data:JSON.stringify(this.data),accept:"json",success:function(e){if(t.text("Status: "+e.message),t.addClass("green-text"),t.removeClass("text-hide red-text"),e.code){let t=$("#signUpForm"),e=t.find("input");for(let t=0;t<e.length;t++)$(e[t]).val("");t.find("select").val("")}},error:function(e,a,r){console.log(e,a,r),"Method Not Allowed"===r&&(a="server not reachable"),t.text("Status: "+a),t.addClass("red-text"),t.removeClass("text-hide green-text")}})}};