$(document).ready(function(){publisher.initialize()});let publisher={formId:"signUpForm",errorMessage:"",errorInputIds:[],data:[],countries:["India","United States","Singapore","France","United Kingdom","Australia","Japan","China","Other"],initialize:function(){let t=$("#"+this.formId),e=t.find("input[data-type=number]");e.length>0&&this.listenOnKeyUp(e),this.initializeAutoCompleteCountry(),t.submit(function(){return!1});let r=this;$("#submit").on("click",function(){r.storeFormDataOnChange()})},initializeAutoCompleteCountry:function(){$("#country").mdbAutocomplete({data:this.countries})},listenOnKeyUp:function(t){for(let e=0;e<t.length;e++)$(t[e]).on("keyup",this.updateField)},updateField:function(t){let e=t.keyCode||t.which,r=$(this),a=r.val();if((e<48||e>57)&&8!==e)return a.length>1&&(a=a.substr(0,a.length-1)),void r.val(a);if("zipcode"!==r.attr("name"))a.length>12?r.val(a.substr(0,a.length-1)):a.length%3==0&&a.length<5&&8!==e?r.val(a+"-"):a.length%7==0&&a.length>5&&8!==e&&r.val(a+"-");else{let t="US";a.length>5&&"US"===t?r.val(a.substr(0,a.length-1)):a.length>7&&r.val(a.substr(0,a.length-1))}},storeFormDataOnChange:function(){let t=$("#"+this.formId).find("input");if(t.length<1)return;this.clearData();for(let e=0;e<t.length;e++){let r=$(t[e]);void 0!==r.attr("validate-field")&&!1!==r.attr("validate-field")&&("number"===r.attr("data-type")?this.validateNumber(r):this.validateValue(r))}let e=this.errorMessage;""===e.trim()&&this.performSubmission(),this.errorMessage="",this.showModalForInputError(e),this.handleModalErrorGoToBtn($("#formErrorModal"))},validateNumber:function(t){let e=t.attr("name"),r=t.val(),a=this,i=/[0-9]/g;void 0!==r&&r.length>1&&/[0-9][-]/g.test(r)?a.addToData(e,r):"zipcode"===t.attr("name")&&void 0!==r&&r.length>1&&i.test(r)?a.addToData(e,r):(this.errorMessage+="Please enter a valid value for "+t.attr("name")+"<br>",this.errorInputIds.push(t.attr("id")))},validateValue:function(t){let e=t.val(),r=t.attr("name"),a=this;if((e.length<1||""===e.trim())&&"address2"!==r)return this.errorMessage+="Please enter a value for "+r+"<br>",void this.errorInputIds.push(t.attr("id"));if(r.toLowerCase().includes("name")||"city"===r||"state"===r){/[a-z]/gi.test(e)?a.addToData(r,e):(this.errorMessage+="Please enter a valid value for "+r+"<br>",this.errorInputIds.push(t.attr("id")))}else if(r.toLowerCase().includes("country")){for(let t=0;t<this.countries.length;t++)if(e.trim()===this.countries[t])return void a.addToData(r,e);this.errorMessage+="Please select a valid option/value for "+r+"<br>",this.errorInputIds.push(t.attr("id"))}else if(r.includes("email")){/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)?a.addToData(r,e):(this.errorMessage+="Please enter a valid value for "+r+"<br>",this.errorInputIds.push(t.attr("id")))}else"address1"===r&&(e.length>1&&""!==e.trim()?a.addToData(r,e):(this.errorMessage+="Please enter a valid value for "+r+"<br>",this.errorInputIds.push(t.attr("id")))),"address2"===r&&e.length>1&&""!==e.trim()&&a.addToData(r,e)},addToData:function(t,e){this.data.push({name:t,value:e})},removeFromData:function(t){this.data.splice(t,1)},clearData:function(){this.data=[]},showModalForInputError:function(t){t.length<2||""===t.trim()||($("#errorMessage").html(t),$("#errorFormFocusBtn").attr("data-link",this.errorInputIds[0]),$("#formErrorModal").modal("show"))},handleModalErrorGoToBtn:function(t){$("#errorFormFocusBtn").on("click",function(){$(this).off("click");let e=$(this).attr("data-link");t.modal("hide"),$("#"+e).focus()})},performSubmission:function(){this.data.push({name:"signUpForm",value:$("#"+this.formId).attr("name")}),console.log(JSON.stringify(this.data));$.ajax({url:"php/advertiseOrPublish.php",type:"POST",data:this.data,accept:"json",success:function(t){if(console.log(t),$("#status").text(t.message),t.code){let t=$("#signUpForm"),e=t.find("input");for(let t=0;t<e.length;t++)$(e[t]).val("");t.find("select").val("")}},error:function(t,e,r){console.log(t,e,r),"Method Not Allowed"===r&&(e="server not reachable")}})}};